document.addEventListener("DOMContentLoaded",()=>{const e=document.documentElement,t=document.getElementById("themeToggle");t&&t.addEventListener("click",()=>{e.classList.toggle("light");const o=e.classList.contains("light");localStorage.setItem("theme",o?"light":"dark"),t.setAttribute("aria-pressed",o?"true":"false"),t.textContent=o?"ðŸŒ¤":"ðŸŒ™"}),t&&(e.classList.contains("light")?t.setAttribute("aria-pressed","true"):t.setAttribute("aria-pressed","false"),t.textContent=e.classList.contains("light")?"ðŸŒ¤":"ðŸŒ™");const o=document.getElementById("year");if(o&&(o.textContent=new Date().getFullYear()),document.getElementById("visitCount")){const e=parseInt(localStorage.getItem("visits")||"0",10)+1;localStorage.setItem("visits",e),document.getElementById("visitCount").textContent=e}const l=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("animate-in"),t.unobserve(e.target))})},{threshold:.12});document.querySelectorAll(".reveal").forEach(e=>l.observe(e));const a=document.getElementById("contactForm");if(a){const e=document.getElementById("formStatus"),t=document.getElementById("submitBtn"),o=a.querySelector("#name"),c=a.querySelector("#email"),i=a.querySelector("#message"),s=document.getElementById("help-name"),r=document.getElementById("help-email"),n=document.getElementById("help-message"),d=e=>!/^\s*@|\s+/.test(e)&&/@/.test(e);[o,c,i].forEach(l=>l.addEventListener("input",()=>{let l=!0;o.value.trim()?(s.textContent="",s.className="help"):(s.textContent="Le nom est requis.",s.className="help error",l=!1),d(c.value)?(r.textContent="",r.className="help"):(r.textContent="Email invalide.",r.className="help error",l=!1),i.value.trim()?(n.textContent="",n.className="help"):(n.textContent="Ã‰crivez un message.",n.className="help error",l=!1),t.disabled=!l})),a.addEventListener("submit",e=>{e.preventDefault();const l=o.value.trim(),m=c.value;if(!l||!d(m)||!i.value.trim())return;const u={name:l,email:m,message:i.value},b=JSON.parse(localStorage.getItem("messages")||"[]");b.push({...u,date:new Date().toISOString()}),localStorage.setItem("messages",JSON.stringify(b)),e&&(e.textContent="Message sauvegardÃ© localement. Merci !"),a.reset(),t.disabled=!0})}const c=document.querySelectorAll(".filter");if(c.length){const e=Array.from(document.querySelectorAll(".project")),t=document.querySelector(".carousel-track"),o=document.querySelector(".carousel-btn.prev"),l=document.querySelector(".carousel-btn.next");let a=0;const i=()=>e.filter(e=>"none"!==e.style.display),s=()=>{if(t){const e=i();e.length?(a=Math.max(0,Math.min(a,e.length-1)),t.style.transform=`translateX(${-(e[a].offsetLeft||0)}px)`):t.style.transform="translateX(0)"}};o&&o.addEventListener("click",()=>{i().length>1&&(a=Math.max(a-1,0),s())}),l&&l.addEventListener("click",()=>{i().length>1&&(a=Math.min(a+1,i().length-1),s())}),c.forEach(o=>{o.addEventListener("click",()=>{c.forEach(e=>e.classList.remove("active")),o.classList.add("active");const l=o.dataset.filter;e.forEach(e=>{e.style.display="all"===l||e.dataset.category===l?"":"none"}),a=0,setTimeout(s,60)})})}});